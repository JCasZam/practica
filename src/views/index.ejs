<!doctype html>
<html lang="en">

<head>


    <%- include('partials/header') %>
    <!-- Metodo para sacar mi id de mi form -->
        <script>
            function obtenerId() {            
              let id = form1.id.value;
              form1.submit();
              return id;
            }
        </script>
</head>

<body>

    <form name = 'form1' class="form-inline" style="margin-left: 23%; margin-top: 20px;">

        <div class="form-group mb-2">
            <label for="staticEmail2" class="sr-only">Email</label>
            <input type="text" readonly class="form-control-plaintext" id="staticEmail2" value="Ingrese id: ">
        </div>
        <div class="form-group mx-sm-3 mb-2">
            <label for="inputPassword2" class="sr-only">Id</label>
            <input type="text" class="form-control" name="id" placeholder="Id" >
        </div>
        <button type="button" class="btn btn-primary mb-2" onclick="obtenerId()">Buscar</button>
    </form>
    <% books.forEach(function(book){ %>
        <!-- En este siguiente bloque de codigo me muestra los datos con el id pero lo pongo manualmente.
             Cuando lo declaro como esta comentado en la siguiente linea me marca id is not defined.
           if(book.id== id) -->  
        <% if(book.id== 20){ %>                  
            <div class="container p-4">
                <p style="margin: 10px;">
                    Resultados de la busqueda:
                </p>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <%= book.id %> / <%= book.nombre %>
                            </div>
                            <div class="card-body">
                                <p> Direccion:
                                    <%= book.direccion %>
                                </p>
                                <p> Edad:
                                    <%= book.edad %>
                                </p>
                                <p> Telefono:
                                    <%= book.telefono %>
                                </p>
                                <p> Sexo:
                                    <%= book.sexo %>
                                </p>
                                <p>
                                    <a class="btn btn-primary" data-toggle="collapse" href="#multiCollapseExample"
                                        role="button" aria-expanded="false"
                                        aria-controls="multiCollapseExample">Detalles Cuenta</a>
                                </p>
                                <div class="row">
                                    <div class="col">
                                        <div class="collapse multi-collapse" id="multiCollapseExample">
                                            <div class="card card-body">
                                                <p> Numero Tarjeta:
                                                    <%= book.cuentabanco.numerotarjeta %>
                                                </p>

                                                <p> Fecha Vencimiento:
                                                    <%= book.cuentabanco.fechavencimiento %>
                                                </p>


                                                <p> Saldo disponible:
                                                    <%= book.cuentabanco.lineacredito.saldodisponible %>
                                                </p>

                                                <p>Saldo por pagar:
                                                    <%= book.cuentabanco.lineacredito.saldoporpagar %>
                                                </p>

                                                <p> Tipo de tarjeta:
                                                    <%= book.cuentabanco.tipotarjeta %>
                                                </p>

                                                <p> Tipo de producto:
                                                    <%= book.cuentabanco.tipoproducto %>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <% } %>
                <% }); %>
                    <div class="container p-4">
                        <p style="margin: 10px;">
                            Clientes: <% var cont2=0; %>
                                <% books.forEach(function(book){ cont2++ });%>
                                    <%= cont2 %>
                        </p>
                        <div class="row">
                            <% var cont=0 %>
                                <% books.forEach(function(book){ %>
                                    <div class="col-md-4" style="margin-top: 20px;">
                                        <div class="card">
                                            <div class="card-header">
                                                <%= book.id %> / <%= book.nombre %>
                                            </div>
                                            <div class="card-body">
                                                <p> Direccion:
                                                    <%= book.direccion %>
                                                </p>
                                                <p> Edad:
                                                    <%= book.edad %>
                                                </p>
                                                <p> Telefono:
                                                    <%= book.telefono %>
                                                </p>
                                                <p> Sexo:
                                                    <%= book.sexo %>
                                                </p>
                                                <p>
                                                    <a class="btn btn-primary" data-toggle="collapse"
                                                        href="#multiCollapseExample<%= cont %>" role="button"
                                                        aria-expanded="false"
                                                        aria-controls="multiCollapseExample<%= cont %>">Detalles
                                                        Cuenta</a>
                                                </p>
                                                <div class="row">
                                                    <div class="col">
                                                        <div class="collapse multi-collapse"
                                                            id="multiCollapseExample<%= cont %>">
                                                            <div class="card card-body">
                                                                <p> Numero Tarjeta:
                                                                    <%= book.cuentabanco.numerotarjeta %>
                                                                </p>

                                                                <p> Fecha Vencimiento:
                                                                    <%= book.cuentabanco.fechavencimiento %>
                                                                </p>


                                                                <p> Saldo disponible:
                                                                    <%= book.cuentabanco.lineacredito.saldodisponible %>
                                                                </p>

                                                                <p>Saldo por pagar:
                                                                    <%= book.cuentabanco.lineacredito.saldoporpagar %>
                                                                </p>

                                                                <p> Tipo de tarjeta:
                                                                    <%= book.cuentabanco.tipotarjeta %>
                                                                </p>

                                                                <p> Tipo de producto:
                                                                    <%= book.cuentabanco.tipoproducto %>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <% cont++ %>
                                        <% }); %>
                        </div>
                    </div>

                    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
                        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
                        crossorigin="anonymous"></script>
                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
                        integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
                        crossorigin="anonymous"></script>
</body>

</html>